import { handleActions } from 'redux-actions';
import * as actions from 'actions';

export default handleActions({
  [actions.fetchPhonesSuccess]: (state, { payload: { phones } }) => {
    const { byId, allIds } = state;
    return {
      ...state,
      byId: phones.reduce((acc, phone) => ({ ...acc, [phone.id]: phone }), byId),
      allIds: phones.reduce((acc, phone) => [...acc, phone.id], allIds),
    };
  },

  [actions.fetchPhonesFailure]: (state, { payload: { e, error } }) => ({ e, error }),

  [actions.loadMorePhonesSuccess]: (state, { payload: { phones } }) => {
    const { byId, allIds } = state;
    return {
      ...state,
      byId: phones.reduce((acc, phone) => ({ ...acc, [phone.id]: phone }), byId),
      allIds: phones.reduce((acc, phone) => [...acc, phone.id], allIds),
    };
  },

  [actions.phoneSearch]: (state, { payload: { value } }) => {
    return {
      ...state,
      search: value,
    };
  },
  [actions.loadMorePhonesFailure]: (state, { payload: { e, error } }) => ({ e, error }),
}, { byId: {}, allIds: [], search: '' });
